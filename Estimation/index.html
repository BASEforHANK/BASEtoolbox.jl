<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Estimation · Documentation for BASEforHANK module</title><meta name="title" content="Estimation · Documentation for BASEforHANK module"/><meta property="og:title" content="Estimation · Documentation for BASEforHANK module"/><meta property="twitter:title" content="Estimation · Documentation for BASEforHANK module"/><meta name="description" content="Documentation for Documentation for BASEforHANK module."/><meta property="og:description" content="Documentation for Documentation for BASEforHANK module."/><meta property="twitter:description" content="Documentation for Documentation for BASEforHANK module."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Documentation for BASEforHANK module</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../SteadyState/">Steady state</a></li><li><a class="tocitem" href="../PerturbationSolution/">Perturbation solution</a></li><li class="is-active"><a class="tocitem" href>Estimation</a><ul class="internal"><li><a class="tocitem" href="#Settings"><span>Settings</span></a></li><li><a class="tocitem" href="#Mode-finding"><span>Mode finding</span></a></li><li><a class="tocitem" href="#Bayesian-estimation"><span>Bayesian estimation</span></a></li></ul></li><li><a class="tocitem" href="../PostEstimation/">Post estimation</a></li><li><a class="tocitem" href="../Tools/">Tools</a></li><li><a class="tocitem" href="../Parsing/">Parser</a></li><li><a class="tocitem" href="../HouseholdProblem/">Household problem</a></li><li><a class="tocitem" href="../examples/baseline/">Baseline example</a></li><li><a class="tocitem" href="../Computational Notes/">Computational Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/BASEforHANK/BASEtoolbox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/main/docs/src/Estimation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Estimation-of-parameters"><a class="docs-heading-anchor" href="#Estimation-of-parameters">Estimation of parameters</a><a id="Estimation-of-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Estimation-of-parameters" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Most of the code of this section is in the submodule <code>Estimation</code></p></div></div><h2 id="Settings"><a class="docs-heading-anchor" href="#Settings">Settings</a><a id="Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Settings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.Parsing.EstimationSettings" href="#BASEforHANK.Parsing.EstimationSettings"><code>BASEforHANK.Parsing.EstimationSettings</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EstimationSettings()</code></pre><p>Collect settings for the estimation of the model parameters in a <code>struct</code>.</p><p>Use package <code>Parameters</code> to provide initial values. Input and output file names are stored in the fields <code>mode_start_file</code>, <code>data_file</code>, <code>save_mode_file</code> and <code>save_posterior_file</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/examples/baseline/Model/input_parameters.jl#L332-L339">source</a></section></article><p>The estimation settings (globally instantiated as <code>e_set</code> in <code>BASEforHANK.jl</code>) manage the following areas of the estimation:</p><ul><li><strong>the match between data and model</strong>: <code>data_file</code> is a path to a .csv-file   that contains quarterly observations of several variables (in columns), named in   <code>observed_vars_input</code>. Missing data is denoted by <code>NaN</code>. If some column-names do not align with the model   variables, <code>data_rename</code> is used. Level variables that should correspond to growth   rates in the data can be selected in <code>growth_rate_select</code>. Measurement errors   will be added for observables in <code>meas_error_input</code></li><li><strong>estimation of variances</strong>: <code>shock_names</code> contain the aggregate shocks in the model,   whose variances are estimated. <code>me_treatment</code> defines how measurement errors   are treated: for <code>:fixed</code>, their variances are fixed by the data-variance, otherwise   they are estimated either with <code>:bounded</code> uniform priors, or <code>:unbounded</code> priors (see <a href="#BASEforHANK.Estimation.measurement_error"><code>BASEforHANK.Estimation.measurement_error()</code></a>). For the latter case, the priors are set in   <code>meas_error_distr</code></li><li><strong>numerical parameters</strong>: the maximum number of iterations to find the mode of the   likelihood (see <a href="#BASEforHANK.Estimation.mode_finding"><code>BASEforHANK.Estimation.mode_finding()</code></a>) is set in <code>max_iter_mode</code>. <code>ndraws</code>, <code>burnin</code>   and <code>mhscale</code> are parameters for the Random-Walk Metropolis Hastings algorithm (see <a href="#BASEforHANK.Estimation.rwmh"><code>BASEforHANK.rwmh()</code></a>)</li><li><strong>estimation flags</strong>: whether to estimate the model is set in <code>estimate_model</code>. <code>compute_hessian</code> determines whether the Hessian is computed after mode finding or set to an identity matrix (see <a href="#BASEforHANK.Estimation.mode_finding"><code>BASEforHANK.Estimation.mode_finding()</code></a>). <code>multi_chain_init</code> sets whether multiple chains in the RWMH (see <a href="#BASEforHANK.Estimation.multi_chain_init"><code>BASEforHANK.Estimation.multi_chain_init()</code></a> and <a href="#BASEforHANK.Estimation.rwmh"><code>BASEforHANK.rwmh()</code></a>) are started from an overdispersed posterior mode. All flags are set to <code>false</code> by default.</li></ul><h2 id="Mode-finding"><a class="docs-heading-anchor" href="#Mode-finding">Mode finding</a><a id="Mode-finding-1"></a><a class="docs-heading-anchor-permalink" href="#Mode-finding" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.Estimation.mode_finding" href="#BASEforHANK.Estimation.mode_finding"><code>BASEforHANK.Estimation.mode_finding</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mode_finding(XSSaggr, A, B, indexes, indexes_aggr, distrSS, compressionIndexes, m_par, n_par, e_set)</code></pre><p>Given definition of observed variables and their transformation (level or growth rate) from <code>e_set</code>, load the data, construct the observation equation, and maximize <a href="#BASEforHANK.Estimation.likeli"><code>likeli()</code></a> (the log-likelihood) using the package <code>Optim</code>.</p><p>Save estimation results to <code>e_set.save_mode_file</code>.</p><p><strong>Returns</strong></p><ul><li><code>par_final</code>: parameter vector that maximizes the likelihood</li><li><code>hessian_final</code>: Hessian of the log-likelihood at <code>par_final</code></li><li><code>posterior_mode</code>: log-likelihood at <code>par_final</code></li><li><code>meas_error</code>,<code>meas_error_std</code>: returns from <a href="#BASEforHANK.Estimation.measurement_error"><code>measurement_error()</code></a></li><li><code>parnames</code>: names of estimated parameters (including measurement error variances)</li><li><code>Data</code>,<code>Data_missing</code>: data from <code>e_set.data_file</code>; marker for missing data</li><li><code>H_sel</code>: selector matrix for states/controls that are observed</li><li><code>priors</code>: priors of parameters (including measurement error variances)</li><li><code>smoother_output</code>: output from the Kalman smoother</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/SubModules/Estimation/mode_finding.jl#L1-L20">source</a></section></article><p>The main computations are the construction of the likelihood of the model parameters and its maximization. We get the model parameters that are to be estimated, together with their priors, from <code>m_par</code> (in addition to measurement error variances, see <a href="#Settings">Settings</a>).</p><p>There is also the option to provide a file with initial guesses of parameters for the mode finding, which might have computational advantages compared to the priors from <code>m_par</code>. In the baseline example we provide these initial guesses through the txt-file named <code>par_final_dict</code>. The first if-condition in the function <code>BASEforHANK.find_mode()</code> guarantees that if the file is not provided, priors from <code>m_par</code> will be used for mode finding. However, if the extra file is provided, the contained dictionary therein is loaded and the specified guesses are assigned to the starting values. Loading it as a dictionary guarantees that the assignment is order-insensitive and thus robust to changes in the individual selection of which parameters are to be estimated. Note that it is also possible to only specify values for a part of the to-be-estimated parameters and in this case the missing starting values will be replaced by the mode of priors from <code>m_par</code>.</p><h3 id="The-likelihood-function"><a class="docs-heading-anchor" href="#The-likelihood-function">The likelihood function</a><a id="The-likelihood-function-1"></a><a class="docs-heading-anchor-permalink" href="#The-likelihood-function" title="Permalink"></a></h3><p>The function <a href="#BASEforHANK.Estimation.likeli"><code>BASEforHANK.Estimation.likeli()</code></a> computes the log-likelihood of the model parameters <code>par</code> in the following steps:</p><ol><li><p>call <a href="#BASEforHANK.PerturbationSolution.LinearSolution_reduced_system"><code>BASEforHANK.PerturbationSolution.LinearSolution_reduced_system()</code></a> to derive the linear state-space representation of the model given <code>par</code>.  Differently from <a href="../PerturbationSolution/#BASEforHANK.PerturbationSolution.LinearSolution"><code>BASEforHANK.PerturbationSolution.LinearSolution()</code></a>, differentiate only the system of <em>aggregate</em> equilibrium  conditions with respect to <em>aggregate</em> variables, i.e. <a href="../PerturbationSolution/#BASEforHANK.PerturbationSolution.Fsys_agg"><code>BASEforHANK.PerturbationSolution.Fsys_agg()</code></a>. This is sufficient,  as the estimated parameters do not enter in the heterogeneous agent part of the equilibrium system <sup class="footnote-reference"><a id="citeref-BBL" href="#footnote-BBL">[BBL]</a></sup>.  Then, update the derivatives <code>A</code> and <code>B</code> of the full model for aggregate variables and conditions,  and compute the observation and state transition equations as in <a href="../PerturbationSolution/#BASEforHANK.PerturbationSolution.LinearSolution"><code>BASEforHANK.PerturbationSolution.LinearSolution()</code></a></p></li><li><p>delete rows of the observation equation that correspond to unobserved controls  (the selector matrix <code>H_sel</code> is constructed in <a href="#BASEforHANK.Estimation.mode_finding"><code>BASEforHANK.Estimation.mode_finding()</code></a>). Then, feed  the linear state-space system, the data, and the variances of the structural and  measurement shocks, into the Kalman filter (see <a href="#BASEforHANK.Estimation.kalman_filter"><code>BASEforHANK.Estimation.kalman_filter()</code></a>), which computes  the log-likelihood</p></li></ol><p>We find the maximizer of the likelihood function, as well as its Hessian at the maximum, with the package <code>Optim</code>. Note that in order to obtain the Hessian, you need to set <code>e_set.compute_hessian = true</code>.</p><h3 id="Called-functions"><a class="docs-heading-anchor" href="#Called-functions">Called functions</a><a id="Called-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Called-functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.Estimation.likeli" href="#BASEforHANK.Estimation.likeli"><code>BASEforHANK.Estimation.likeli</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">likeli(par, Data, Data_missing, H_sel, priors, meas_error, meas_error_std, sr, lr, m_par, e_set; smoother=false)</code></pre><p>Compute the likelihood of <code>Data</code>, given model-parameters <code>par</code> and prior <code>priors</code> (maximize to find MLE of <code>par</code>).</p><p>Solve model with <a href="#BASEforHANK.PerturbationSolution.LinearSolution_reduced_system"><code>LinearSolution_reduced_system()</code></a>, compute likelihood with <a href="#BASEforHANK.Estimation.kalman_filter"><code>kalman_filter()</code></a> or with <a href="#BASEforHANK.Estimation.kalman_filter_smoother"><code>kalman_filter_smoother()</code></a> (if <code>smoother==True</code>).</p><p><strong>Returns</strong></p><p><em>if <code>smoother==False</code>:</em></p><ul><li><code>log_like</code>,<code>prior_like</code>,<code>post_like</code>,<code>alarm</code>: log-likelihoods (<code>post</code> is the sum of <code>prior</code> and computed likelihood); <code>alarm</code> indicates error when solving model with <a href="#BASEforHANK.PerturbationSolution.LinearSolution_reduced_system"><code>LinearSolution_reduced_system</code></a>, sets log-likelihood to <code>-9.e15</code></li></ul><p><em>if <code>smoother==True</code>:</em></p><ul><li><code>smoother_output</code>: returns from <a href="#BASEforHANK.Estimation.kalman_filter_smoother"><code>kalman_filter_smoother()</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/SubModules/Estimation/likeli.jl#L1-L12">source</a></section><section><div><pre><code class="language-julia hljs">likeli(par, sr, lr, er, m_par, e_set; smoother=false)</code></pre><p>Compute the likelihood of <code>er.Data</code>, given model-parameters <code>par</code> and prior <code>er.priors</code> (maximize to find MLE of <code>par</code>).</p><p>Solve model with <a href="#BASEforHANK.PerturbationSolution.LinearSolution_reduced_system"><code>LinearSolution_reduced_system()</code></a>, compute likelihood with <a href="#BASEforHANK.Estimation.kalman_filter"><code>kalman_filter()</code></a> or with <a href="#BASEforHANK.Estimation.kalman_filter_smoother"><code>kalman_filter_smoother()</code></a> (if <code>smoother==True</code>).</p><p><strong>Returns</strong></p><p><em>if <code>smoother==False</code>:</em></p><ul><li><code>log_like</code>,<code>prior_like</code>,<code>post_like</code>,<code>alarm</code>: log-likelihoods (<code>post</code> is the sum of <code>prior</code> and computed likelihood); <code>alarm</code> indicates error when solving model with <a href="#BASEforHANK.PerturbationSolution.LinearSolution_reduced_system"><code>LinearSolution_reduced_system</code></a>, sets log-likelihood to <code>-9.e15</code></li></ul><p><em>if <code>smoother==True</code>:</em></p><ul><li><code>smoother_output</code>: returns from <a href="#BASEforHANK.Estimation.kalman_filter_smoother"><code>kalman_filter_smoother()</code></a></li><li><code>State2Control</code>,<code>LOM</code>: state-to-control and state transition matrizzes</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/SubModules/Estimation/likeli.jl#L43-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.PerturbationSolution.LinearSolution_reduced_system" href="#BASEforHANK.PerturbationSolution.LinearSolution_reduced_system"><code>BASEforHANK.PerturbationSolution.LinearSolution_reduced_system</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearSolution_reduced_system(sr, m_par, A, B,;allow_approx_sol)</code></pre><p>Calculate the linearized solution to the non-linear difference equations defined by function <a href="../PerturbationSolution/#BASEforHANK.PerturbationSolution.Fsys"><code>Fsys</code></a>, while only differentiating with respect to the aggregate part of the model, <a href="../PerturbationSolution/#BASEforHANK.PerturbationSolution.Fsys_agg"><code>Fsys_agg()</code></a>.</p><p>The partials of the Jacobian belonging to the heterogeneous agent part of the model are taken from the full-model derivatives provided as arguments, <code>A</code> and <code>B</code> (computed by <a href="../PerturbationSolution/#LinearSolution()"><code>LinearSolution()</code></a>).</p><p><strong>Arguments</strong></p><ul><li><code>sr</code>: steady-state structure (variable values, indexes, numerical parameters, ...)</li><li><code>A</code>,<code>B</code>: derivative of <a href="../PerturbationSolution/#Fsys()"><code>Fsys()</code></a> with respect to arguments <code>X</code> [<code>B</code>] and   <code>XPrime</code> [<code>A</code>]</li><li><code>m_par</code>: model parameters</li><li><code>allow_approx_sol</code>: if <code>true</code>, the function will attempt to solve the linearized model   even if the system is indeterminate (shifting the critical eigenvalues)</li></ul><p><strong>Returns</strong></p><p>as in <a href="../PerturbationSolution/#LinearSolution()"><code>LinearSolution()</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/SubModules/PerturbationSolution/LinearSolution_reduced_system.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.Estimation.kalman_filter" href="#BASEforHANK.Estimation.kalman_filter"><code>BASEforHANK.Estimation.kalman_filter</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kalman_filter(H,LOM,Data,D_miss,SCov,MCov,e_set)</code></pre><p>Compute likelihood of <code>Data</code>, applying the Kalman filter to the state-space represenation (<code>H</code>,<code>LOM</code>) of the model.</p><p><strong>Arguments</strong></p><ul><li><code>H::Array{Float64,2}</code>: observation equation</li><li><code>LOM::Array{Float64,2}</code>: law of motion for states</li><li><code>Data::Array{Union{Missing,Float64},2}</code>,<code>D_miss::BitArray{2}</code>: data (time <span>$\times$</span> variable); marker for missing data</li><li><code>SCov::Array{Float64,2}</code>: covariance of structural shocks</li><li><code>MCov::Array{Float64,2}</code>: covariance of measurement error</li></ul><p><strong>Returns</strong></p><ul><li>log-likelihood</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/SubModules/Estimation/filter_smoother.jl#L7-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.Estimation.measurement_error" href="#BASEforHANK.Estimation.measurement_error"><code>BASEforHANK.Estimation.measurement_error</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">measurement_error(Data,observed_vars,e_set)</code></pre><p>Build measurement error.</p><p><strong>Arguments</strong></p><ul><li><code>Data</code>: matrix of observables [nobs * nvar]</li><li><code>observed_vars</code>: vector of observed variable names [nvar * 1]</li><li><code>e_set::EstimationSettings</code></li></ul><p><strong>Returns</strong></p><ul><li><code>meas_error</code>: ordered dictionary of measurement errors linked to observables</li><li><code>meas_error_prior</code>: corresponding priors for measurement errors</li><li><code>meas_error_std</code>: standard deviations of observables with measurement error</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/SubModules/Estimation/measurement_error.jl#L1-L15">source</a></section></article><h2 id="Bayesian-estimation"><a class="docs-heading-anchor" href="#Bayesian-estimation">Bayesian estimation</a><a id="Bayesian-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-estimation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.sample_posterior" href="#BASEforHANK.sample_posterior"><code>BASEforHANK.sample_posterior</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mcmc_estimation(sr, lr, er, m_par, e_set)</code></pre><p>Sample posterior of parameter vector with <a href="#BASEforHANK.Estimation.rwmh"><code>rwmh()</code></a>, take sample mean as parameter estimate, and save all results in <code>file</code>.</p><p><strong>Arguments</strong></p><ul><li><code>sr::SteadyResults</code>: Output of <a href="../SteadyState/#BASEforHANK.call_prepare_linearization"><code>call_prepare_linearization()</code></a></li><li><code>lr::LinearResults</code>: Output of <a href="../PerturbationSolution/#linearize_full_model()"><code>linearize_full_model()</code></a></li><li><code>er::EstimResults</code>: Output of <a href="#BASEforHANK.find_mode"><code>find_mode()</code></a></li><li><code>m_par::ModelParameters</code></li><li><code>e_set::EstimationSettings</code></li></ul><p><strong>Returns</strong></p><ul><li><code>sr::SteadyResults</code>: Updated <code>SteadyResults</code></li><li><code>lr::LinearResults</code>: Updated <code>LinearResults</code></li><li><code>er::EstimResults</code>: Updated <code>EstimResults</code></li><li><code>m_par::ModelParameters</code>: Updated <code>ModelParameters</code></li><li><code>draws_raw::Array{Float64,2}</code>: Raw draws from the posterior</li><li><code>posterior::Array{Float64,1}</code>: Posterior</li><li><code>accept_rate::Float64</code>: Acceptance rate</li><li><code>par_final::Array{Float64,1}</code>: Mode of the posterior</li><li><code>hessian_sym::Symmetric{Float64,Array{Float64,2}}</code>: Hessian of the posterior</li><li><code>smoother_output::Array{Float64,2}</code>: Smoother output</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/BASEforHANK.jl#L336-L360">source</a></section></article><p>We use a Monte Carlo Markov Chain method, specifically the Random-Walk Metropolis Hastings (<a href="#BASEforHANK.Estimation.rwmh"><code>BASEforHANK.Estimation.rwmh()</code></a>) algorithm, to sample from the posterior probability distribution of the parameter vector. The acceptance rate of the algorithm can be adjusted via setting <code>EstimationSettings.mhscale</code>. To obtain the posterior likelihood of each draw, we call <a href="#BASEforHANK.Estimation.likeli"><code>BASEforHANK.Estimation.likeli()</code></a>, which evaluates the priors at <code>par</code> (<a href="#BASEforHANK.Estimation.prioreval"><code>BASEforHANK.Estimation.prioreval()</code></a>) and returns the log-posterior as a sum of the log-prior and the log-likelihood.</p><p>Given the draws from the posterior, we can analyze the probabilities of the parameters using the package <code>MCMCChains</code>. We take the average over the draws as our Bayesian estimate of the parameter vector, <code>par_final</code>. To obtain an estimate of the underlying state over the data sample period, we call <a href="#BASEforHANK.Estimation.likeli"><code>BASEforHANK.Estimation.likeli()</code></a> with <code>par_final</code> and keyword <code>smoother=true</code> (this calls the Kalman smoother <a href="#BASEforHANK.Estimation.kalman_filter_smoother"><code>BASEforHANK.Estimation.kalman_filter_smoother()</code></a>). The result is stored in <code>smoother_output</code>, and saved with the other results in <code>e_set.save_posterior_file</code>.</p><h3 id="Called-functions-2"><a class="docs-heading-anchor" href="#Called-functions-2">Called functions</a><a class="docs-heading-anchor-permalink" href="#Called-functions-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.Estimation.rwmh" href="#BASEforHANK.Estimation.rwmh"><code>BASEforHANK.Estimation.rwmh</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rwmh(xhat, Σ, sr, lr, er, m_par, e_set)</code></pre><p>Sample the posterior of the parameter vector using the Random-Walk Metropolis Hastings algorithm.</p><p><strong>Returns</strong></p><ul><li><code>draws::Array{Float64,2}</code>: <code>e_set.ndraws + e_set.burnin</code> sampled parameter vectors (row vectors)</li><li><code>posterior</code>: vector of posteriors for the respective draws</li><li><code>accept_rate</code>: acceptance rate</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/SubModules/Estimation/mcmc.jl#L6-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.Estimation.multi_chain_init" href="#BASEforHANK.Estimation.multi_chain_init"><code>BASEforHANK.Estimation.multi_chain_init</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">multi_chain_init(xhat, Σ, sr, lr, er, m_par, e_set)</code></pre><p>Draw overdispersed initial values for multi-chain RWMH.</p><p><strong>Returns</strong></p><ul><li><code>init_draw</code>: overdispersed starting value for chain</li><li><code>init_draw</code>: Bool variable indicating whether search was succesful</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/SubModules/Estimation/mcmc.jl#L70-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.Estimation.prioreval" href="#BASEforHANK.Estimation.prioreval"><code>BASEforHANK.Estimation.prioreval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prioreval(par,priors)</code></pre><p>Evaluate prior PDF at the parameters given in <code>par</code>.</p><p><strong>Arguments</strong></p><ul><li><code>par</code>: vector of parameters [npar*1]</li><li><code>priors</code>: vector of prior distributions [npar*1]</li></ul><p><strong>Returns</strong></p><ul><li><code>log_priorval</code>: log prior density [scalar]</li><li><code>alarm</code>: indicator that is 1 if there is a violation of the prior bounds [scalar]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/SubModules/Estimation/likeli.jl#L169-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.Estimation.kalman_filter_smoother" href="#BASEforHANK.Estimation.kalman_filter_smoother"><code>BASEforHANK.Estimation.kalman_filter_smoother</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kalman_filter_smoother(H, LOM, Data, D_nomiss, SCov, MCov, e_set)</code></pre><p>Compute likelihood and estimate of underlying states given the full observed <code>Data</code> by applying the Kalman smoother to the state-space representation (<code>H</code>,<code>LOM</code>) of the model.</p><p><strong>Arguments</strong></p><ul><li><code>H::Array{Float64,2}</code>: observation equation</li><li><code>LOM::Array{Float64,2}</code>: law of motion for states</li><li><code>Data::Array{Union{Missing,Float64},2}</code>,<code>D_nomiss::BitArray{2}</code>: data (time <span>$\times$</span> variable); marker for existent data</li><li><code>SCov::Array{Float64,2}</code>: covariance of structural shocks</li><li><code>MCov::Array{Float64,2}</code>: covariance of measurement error</li></ul><p><strong>Returns</strong></p><ul><li><code>log_lik</code>: log-likelihood</li><li><code>xhat_tgt</code>,<code>xhat_tgT</code>: estimate of underlying states from forward iteration [<code>xhat_tgt</code>] and   backward iteration [<code>xhat_tgT</code>]</li><li><code>Sigma_tgt</code>,<code>Sigma_tgT</code>: estimate of covariance matrices from forward iteration [<code>Sigma_tgt</code>]   and backward iteration [<code>Sigma_tgT</code>]</li><li><code>s</code>,<code>m</code>: smoothed structural shocks [<code>s</code>] and measurement errors [<code>m</code>]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/SubModules/Estimation/filter_smoother.jl#L198-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BASEforHANK.find_mode" href="#BASEforHANK.find_mode"><code>BASEforHANK.find_mode</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_mode(sr, lr, m_par, e_set)</code></pre><p>Find parameter that maximizes likelihood of data given linearized model <code>lr</code>.</p><p><strong>Arguments</strong></p><ul><li><code>sr::SteadyResults</code>: Output of <a href="../SteadyState/#BASEforHANK.call_prepare_linearization"><code>call_prepare_linearization()</code></a></li><li><code>lr::LinearResults</code>: Output of <a href="../PerturbationSolution/#linearize_full_model()"><code>linearize_full_model()</code></a></li><li><code>m_par::ModelParameters</code></li><li><code>e_set::EstimationSettings</code></li></ul><p><strong>Returns</strong></p><ul><li><code>EstimResults</code>, containing all returns of <a href="#BASEforHANK.Estimation.mode_finding"><code>mode_finding()</code></a></li><li><code>posterior_mode::Array{Float64,1}</code>: Mode of the posterior</li><li><code>smoother_output::Array{Float64,2}</code>: Smoother output</li><li><code>sr::SteadyResults</code>: Updated <code>SteadyResults</code></li><li><code>lr::LinearResults</code>: Updated <code>LinearResults</code></li><li><code>m_par::ModelParameters</code>: Updated <code>ModelParameters</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/c66dab9905ed29d876cba3d6abb57eeed3a9650b/src/BASEforHANK.jl#L243-L261">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-BBL"><a class="tag is-link" href="#citeref-BBL">BBL</a>For details, see the paper <a href="https://www.benjaminborn.de/files/BBL_Inequality_Sep2023.pdf">Shocks, Frictions, and Inequality in US Business Cycles</a>, <em>American Economic Review</em>, forthcoming.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../PerturbationSolution/">« Perturbation solution</a><a class="docs-footer-nextpage" href="../PostEstimation/">Post estimation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Tuesday 29 April 2025 08:42">Tuesday 29 April 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
