<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Documentation for BASEforHANK module</title><meta name="title" content="Home · Documentation for BASEforHANK module"/><meta property="og:title" content="Home · Documentation for BASEforHANK module"/><meta property="twitter:title" content="Home · Documentation for BASEforHANK module"/><meta name="description" content="Documentation for Documentation for BASEforHANK module."/><meta property="og:description" content="Documentation for Documentation for BASEforHANK module."/><meta property="twitter:description" content="Documentation for Documentation for BASEforHANK module."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Documentation for BASEforHANK module</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Home</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#First-steps"><span>First steps</span></a></li></ul></li><li><a class="tocitem" href="SteadyState.html">Steady state</a></li><li><a class="tocitem" href="PerturbationSolution.html">Perturbation solution</a></li><li><a class="tocitem" href="Estimation.html">Estimation</a></li><li><a class="tocitem" href="PostEstimation.html">Post estimation</a></li><li><a class="tocitem" href="Tools.html">Tools</a></li><li><a class="tocitem" href="Parsing.html">Parser</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/BASEforHANK/BASEtoolbox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/BASEforHANK/BASEtoolbox.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="BASEforHANK.jl-Documentation"><a class="docs-heading-anchor" href="#BASEforHANK.jl-Documentation">BASEforHANK.jl Documentation</a><a id="BASEforHANK.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#BASEforHANK.jl-Documentation" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>This manual documents the Julia module <strong>BASEforHANK</strong>, that provides a toolbox for the BAyesian Solution and Estimation (BASE) of a heterogeneous-agent New-Keynesian (HANK) model. It accompanies the paper <a href="https://www.benjaminborn.de/publication/bbl_inequality_2020/">Shocks, Frictions, and Inequality in US Business Cycles</a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The toolbox is not a 1-for-1 replication package for the linked paper. In particular, the preset resolution is smaller.</p></div></div><h2 id="First-steps"><a class="docs-heading-anchor" href="#First-steps">First steps</a><a id="First-steps-1"></a><a class="docs-heading-anchor-permalink" href="#First-steps" title="Permalink"></a></h2><p>The module runs with Julia 1.10.0. We recommend to use <a href="https://www.julia-vscode.org">Julia for VSCode IDE</a> as a front-end to Julia. To get started with the toolbox, simply download or clone the folder, e.g. via <code>git clone</code>, <code>cd</code> to the project directory and call</p><pre><code class="language-julia-repl hljs">(v1.10) pkg&gt; activate .

(BASEtoolbox) pkg&gt; instantiate</code></pre><p>This will install all needed packages. For more on Julia environments, see <a href="https://julialang.github.io/Pkg.jl/v1/environments/#Using-someone-else&#39;s-project"><code>Pkg.jl</code></a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Before you activate the environment, make sure that you are in the main directory, in which the <code>Manifest.toml</code> and <code>Project.toml</code> files are located. In case you accidentally activated the environment in a subfolder, empty <code>.toml</code> files will be created that you need to delete before proceeding in the correct folder.</p></div></div><p>For an introduction, it is easiest to use the Julia script <code>script.jl</code> in the <code>src</code> folder. Make sure that the folder is the present working directory and that the bottom bar in VSCode shows <code>Julia env: BASEtoolbox</code>.<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> At the top of the script file, we pre-process some user input regarding the aggregate model and the steady state (see below) and write them them into the respective functions in the folder <code>Preprocessor\generated_fcns</code>. This has to be done before the BASEforHANK module, defined in <code>BASEforHANK.jl</code>, is loaded via</p><pre><code class="nohighlight hljs">include(&quot;BASEforHANK.jl&quot;)
using .BASEforHANK</code></pre><p><code>BASEforHANK.jl</code> is the key module file as it loads in the code base, sets up structures, and exports a number of functions and macros.</p><p>The provided <code>script.jl</code> then shows how a typical estimation proceeds in three main steps. First, we solve the steady state of the model. Then, the algorithm performs a two-step dimensionality reduction as described in the accompanying paper.<sup class="footnote-reference"><a id="citeref-BBL" href="#footnote-BBL">[BBL]</a></sup> The second step of this reduction uses the prior information to obtain and approximate factor representation from an initial, not further reduced solution. Secondly, we compute the linearized dynamics of the reduced model around the steady state. Thirdly, we construct the likelihood of the model parameters given the data and use Bayesian methods to estimate them. More details on the three steps are provided in the menu on the left. <code>script.jl</code> also provides an example on how to plot some impulse response functions from the model.</p><h3 id="Setting-up-your-model"><a class="docs-heading-anchor" href="#Setting-up-your-model">Setting up your model</a><a id="Setting-up-your-model-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-up-your-model" title="Permalink"></a></h3><p>To define the aggregate part of the model, include the aggregate model block in <code>Model\input_aggregate_model.jl</code>. The model variables are divided into <em>states</em> (distribution, productivity, ...) and <em>controls</em> (consumption policy or marginal utilities/value functions, prices, aggregate capital stock, ...). The aggregate variables (i.e. excluding the distribution and marginal utilities/value functions) are defined  in <code>Model\include_aggregate_names</code> and their steady states in <code>Model\input_aggregate_steady_state</code>. Include model parameters in <code>struct ModelParameters</code> in <code>Model\Parameters.jl</code>.</p><p>The file <code>Parameters.jl</code> contains three structures to provide model parameters, numerical parameters, and estimation settings. In addition, it contains two macros that automatically create structures that contain the model variables.</p><p>The model parameters for the steady state have to be calibrated. We set them in the <code>struct</code> <a href="SteadyState.html#BASEforHANK.Parsing.ModelParameters"><code>ModelParameters</code></a>. It also contains all other parameters that are estimated, including the stochastic process-parameters for the aggregate shocks. Each model parameter has a line of code. It starts with the parameter name as it is used in the code and a default value. The next two entries are its ascii name and its name for LaTeX output. The fourth entry is the prior if the parameter is to be estimated. Please see the <a href="https://github.com/JuliaStats/Distributions.jl">Distributions.jl</a>-package for available options. The fifth entry is a Boolean whether the parameter should be estimated (<code>true</code>) or not (<code>false</code>).</p><p>The folder <code>Model</code> also contains the mapping of prices to household incomes (given the idiosyncratic state space). This can be found in the subfolder <code>IncomesETC</code>. Depending on the adjustments to the macroeconomic model, the user needs to adjust this mapping from prices to incomes. Similarly, the subfolder contains definitions of utility functions, profit functions, employment demand, etc. that are used in the calculation of the steady state equilibrium.</p><h3 id="Steady-state-and-first-dimensionality-reduction"><a class="docs-heading-anchor" href="#Steady-state-and-first-dimensionality-reduction">Steady state and first dimensionality reduction</a><a id="Steady-state-and-first-dimensionality-reduction-1"></a><a class="docs-heading-anchor-permalink" href="#Steady-state-and-first-dimensionality-reduction" title="Permalink"></a></h3><p>The command</p><pre><code class="nohighlight hljs">sr_full = compute_steadystate(m_par)</code></pre><p>calls the functions <a href="SteadyState.html#BASEforHANK.SteadyState.find_steadystate"><code>BASEforHANK.find_steadystate()</code></a> and <a href="SteadyState.html#BASEforHANK.PerturbationSolution.prepare_linearization"><code>BASEforHANK.prepare_linearization()</code></a> and saves their returns in an instance <code>sr_full</code> of the <code>struct</code> <code>SteadyResults</code>. <code>sr_full</code> contains vectors of the steady-state variables (together with index-vectors to reference them by name) and the steady-state distribution of income and assets. It also contains the marginal value functions and the distributions as well as their first-stage model reduction counterparts (obtained through DCTs).</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p><code>sr_full</code> may be saved to the local file system by calling</p><pre><code class="nohighlight hljs">@save &quot;Output/Saves/steadystate.jld2&quot; sr_full</code></pre><p>and can be loaded for a future session with</p><pre><code class="nohighlight hljs">@load &quot;Output/Saves/steadystate.jld2&quot; sr_full</code></pre></div></div><p>More details can be found in the section &quot;Steady State&quot;.</p><h3 id="Linearize-full-model"><a class="docs-heading-anchor" href="#Linearize-full-model">Linearize full model</a><a id="Linearize-full-model-1"></a><a class="docs-heading-anchor-permalink" href="#Linearize-full-model" title="Permalink"></a></h3><p>After computing the steady state and saving it in the <code>SteadyResults</code>-struct named <code>sr_full</code>,</p><pre><code class="nohighlight hljs">lr_full = linearize_full_model(sr_full, m_par)</code></pre><p>computes the linear dynamics of the &quot;full&quot; model, i.e., using the first-stage model reduction, around the steady state (in the background, this calls <a href="PerturbationSolution.html#BASEforHANK.PerturbationSolution.LinearSolution"><code>BASEforHANK.PerturbationSolution.LinearSolution()</code></a>) and saves a state-space representation in the instance <code>lr_full</code> of the <code>struct</code> <code>LinearResults</code> (see <a href="PerturbationSolution.html#linearize_full_model()"><code>linearize_full_model()</code></a>).</p><p>Linearization of the full model takes a few seconds. The resulting state space is relatively large, because the copula and the value functions are treated fully flexible in this first step. As a result, also computing the first-order dynamics of this model takes a few seconds as well.</p><h3 id="Model-reduction"><a class="docs-heading-anchor" href="#Model-reduction">Model reduction</a><a id="Model-reduction-1"></a><a class="docs-heading-anchor-permalink" href="#Model-reduction" title="Permalink"></a></h3><p>This large state-space representation can, however, be reduced substantially using an approximate factor representation. For this purpose, run  </p><pre><code class="nohighlight hljs">sr_reduc    = model_reduction(sr_full, lr_full, m_par)</code></pre><p>which calculates the unconditional covariance matrix of all state and control variables and rewrites the coefficients of the value functions and the copula as linear combinations of some underlying factors. Only those factors that have eigenvalues above the precision predefined in <code>sr_full.n_par.compress_critC</code> (controls, i.e., marginal value functions) and <code>sr_full.n_par.compress_critS</code> (states, i.e., the copula) are retained.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>After model reduction, <code>sr_reduc.indexes_r</code> contains the indexes that map correctly into the states/controls used in <code>LOMstate</code> and <code>State2Control</code>.</p></div></div><h3 id="Model-solution-after-a-parameter-change-/-after-reduction"><a class="docs-heading-anchor" href="#Model-solution-after-a-parameter-change-/-after-reduction">Model solution after a parameter change / after reduction</a><a id="Model-solution-after-a-parameter-change-/-after-reduction-1"></a><a class="docs-heading-anchor-permalink" href="#Model-solution-after-a-parameter-change-/-after-reduction" title="Permalink"></a></h3><p>This smaller model (or any model after a parameter change that doesn&#39;t affect the steady state) can be solved quickly using a factorization result from <sup class="footnote-reference"><a id="citeref-BBL" href="#footnote-BBL">[BBL]</a></sup> running</p><pre><code class="nohighlight hljs">lr_reduc    = update_model(sr_reduc, lr_full, m_par)</code></pre><p>In the background, this calls <a href="Estimation.html#BASEforHANK.PerturbationSolution.LinearSolution_estim"><code>BASEforHANK.PerturbationSolution.LinearSolution_estim()</code></a>, which only updates the Jacobian entries that regard the <strong>aggregate</strong> model. (Note that both <a href="PerturbationSolution.html#BASEforHANK.PerturbationSolution.LinearSolution"><code>BASEforHANK.PerturbationSolution.LinearSolution()</code></a> and <a href="Estimation.html#BASEforHANK.PerturbationSolution.LinearSolution_estim"><code>BASEforHANK.PerturbationSolution.LinearSolution_estim()</code></a> call <a href="PerturbationSolution.html#BASEforHANK.PerturbationSolution.SolveDiffEq"><code>BASEforHANK.PerturbationSolution.SolveDiffEq()</code></a> to obtain a solution to the linearized difference equation.)</p><p>This model update step takes about 100ms on a standard computer for the medium size resolution used as a default in the example code.</p><h3 id="Estimation-of-model-parameters"><a class="docs-heading-anchor" href="#Estimation-of-model-parameters">Estimation of model parameters</a><a id="Estimation-of-model-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Estimation-of-model-parameters" title="Permalink"></a></h3><p>Having obtained <code>SteadyResults</code> <code>sr_reduc</code> and <code>LinearResults</code> <code>lr_reduc</code>, the command</p><pre><code class="nohighlight hljs">er_mode = find_mode(sr_reduc, lr_reduc, m_par)</code></pre><p>computes the mode of the likelihood, i.e., the parameter vector that maximizes the probability of observing the data given the model, and saves the results in <code>er_mode</code>, an instance of <code>struct</code> <code>EstimResults</code> (see <a href="Estimation.html#BASEforHANK.Estimation.mode_finding"><code>BASEforHANK.Estimation.mode_finding()</code></a>). We use the Kalman filter to compute the likelihood, and the package <code>Optim</code> for optimization. Settings for the estimation can adjusted in the <code>struct</code> <a href="Estimation.html#BASEforHANK.Parsing.EstimationSettings"><code>EstimationSettings</code></a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>By default, the flag <code>estimate_model</code> in the <code>struct</code> <a href="Estimation.html#BASEforHANK.Parsing.EstimationSettings"><code>EstimationSettings</code></a> is set to <code>false</code>. Depending on the computing power available, finding the mode of the likelihood can take several hours to run through. The mode finder might also seem frozen after finishing the optimization but the computation of the Hessian for the large model is involved and can take a long time for the large model. For instructional purposes, we therefore set <code>e_set.compute_hessian = false</code> by default and load the Hessian from a save file. For a proper estimation, this has to be set to true. We also save an intermediate step before computing the Hessian in case you are only interested in the mode itself.</p></div></div><p>Lastly,</p><pre><code class="nohighlight hljs">sample_posterior(sr_reduc, lr_reduc, er_mode, m_par)</code></pre><p>uses a Markov Chain Monte Carlo method to trace out the posterior probabilites of the estimated parameters. The final estimates (and further results) are saved in a file with the name given by the field <code>save_posterior_file</code> in the <code>struct</code> <code>EstimationSettings</code> (instantiated in <code>e_set</code>).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The module <code>BASEforHANK</code> creates the estimation settings <code>e_set</code> in its main script (when it is initialized), so changes to the <code>struct</code> <code>EstimationSettings</code> are only effective <em>before</em> <code>using BASEforHANK</code>. Make sure that all file paths specified in <a href="Estimation.html#BASEforHANK.Parsing.EstimationSettings"><code>EstimationSettings</code></a> are correct relative to your script&#39;s position.</p></div></div><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>If you use a different editor, make sure that the environment is correctly set, as otherwise the instantiated packages might not be found.</li><li class="footnote" id="footnote-BBL"><a class="tag is-link" href="#citeref-BBL">BBL</a>For details, see the paper <a href="https://www.benjaminborn.de/files/BBL_Inequality_Sep2023.pdf">Shocks, Frictions, and Inequality in US Business Cycles</a>, <em>American Economic Review</em>, forthcoming.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="SteadyState.html">Steady state »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Sunday 3 March 2024 20:26">Sunday 3 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
